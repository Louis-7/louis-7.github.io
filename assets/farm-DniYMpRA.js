import"./modulepreload-polyfill-B5Qt9EMX.js";const h=document.getElementById("gameCanvas"),e=h.getContext("2d"),M=document.getElementById("interaction-prompt"),v=document.getElementById("modal-overlay"),Z=document.getElementById("modal-body"),J=document.getElementById("close-btn");let E,p,u,R,P,Y,X;const $=`
<div id="settings-panel">
    <div class="panel-header" id="panel-header">
        <span>‚öôÔ∏è MENU</span>
        <span id="toggle-icon">‚ñº</span>
    </div>
    <div class="panel-body">
        <div class="control-group">
            <span class="control-label">Current Season</span>
            <button class="pixel-btn" id="season-btn">SPRING</button>
        </div>
        <div class="control-group">
            <span class="control-label">Map Editor</span>
            <button class="pixel-btn" id="editor-toggle-btn">Enable Editing</button>
            <div id="editor-tools">
                <button class="tool-btn active" onclick="setTool('tree')">üå≤</button>
                <button class="tool-btn" onclick="setTool('rock')">ü™®</button>
                <button class="tool-btn" onclick="setTool('flower')">üå∏</button>
                <button class="tool-btn" onclick="setTool('plant')">üåø</button>
                <button class="tool-btn" onclick="setTool('cow')">üêÑ</button>
                <button class="tool-btn" onclick="setTool('chicken')">üêî</button>
                <button class="tool-btn" onclick="setTool('horse')">üêé</button>
                <button class="tool-btn" onclick="setTool('sheep')">üêè</button>
                <button class="tool-btn" onclick="setTool('erase')">‚ùå</button>
            </div>
        </div>
        <div class="control-group">
            <button class="pixel-btn" onclick="exportMap()" style="font-size: 8px;">üíæ Copy Map JSON</button>
        </div>
        <div class="control-group">
            <span class="control-label">Debug</span>
            <button class="pixel-btn" id="debug-toggle-btn">Show Coords</button>
        </div>
    </div>
</div>`;window.openSesame=function(){if(document.getElementById("settings-panel"))return;const t=document.getElementById("ui-layer"),l=document.getElementById("interaction-prompt"),o=document.createElement("div");o.innerHTML=$,t.insertBefore(o.firstElementChild,l),E=document.getElementById("settings-panel"),p=document.getElementById("season-btn"),u=document.getElementById("editor-toggle-btn"),R=document.getElementById("debug-toggle-btn"),P=document.getElementById("editor-tools"),Y=document.getElementById("panel-header"),X=document.getElementById("toggle-icon"),K(),p&&(p.innerText=L[n.season.current]),console.log("Developer Mode Enabled")};const S=4,b=32,G=6e4,L=["Spring","Summer","Fall","Winter"],c={minX:-800,maxX:800,minY:-600,maxY:600},k=.5,q={cow:{body:"#e3dac9",spots:"#5d4037",snout:"#f8bbd0"},chicken:{body:"#ffffff",comb:"#c0392b",beak:"#f1c40f"},horse:{body:"#a1887f",mane:"#5d4037",snout:"#d7ccc8"},sheep:{body:"#ecf0f1",head:"#34495e",legs:"#34495e"}},C={Spring:{grass:"#76c758",grassDark:"#66b04a",dirt:"#8b5e3c",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#c0392b",water:"#3498db",treeLight:"#2ecc71",treeDark:"#27ae60",flowerStem:"#27ae60",flowerPetal:"#e74c3c",cropLeaf:"#2ecc71",cropFruit:["#e74c3c","#f1c40f","#9b59b6"]},Summer:{grass:"#53c738",grassDark:"#41a02a",dirt:"#8b5e3c",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#c0392b",water:"#3498db",treeLight:"#2ecc71",treeDark:"#27ae60",flowerStem:"#27ae60",flowerPetal:"#f39c12",cropLeaf:"#27ae60",cropFruit:["#c0392b","#e67e22","#f39c12"]},Fall:{grass:"#d68910",grassDark:"#b9770e",dirt:"#6e4c30",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#922b21",water:"#2e86c1",treeLight:"#e67e22",treeDark:"#d35400",flowerStem:"#8b5e3c",flowerPetal:"#8e44ad",cropLeaf:"#d35400",cropFruit:["#e67e22","#8e44ad","#c0392b"]},Winter:{grass:"#ecf0f1",grassDark:"#bdc3c7",dirt:"#95a5a6",wood:"#7f8c8d",woodDark:"#555",roof:"#2c3e50",water:"#aed6f1",treeLight:"#dfe6e9",treeDark:"#b2babb",flowerStem:"#95a5a6",flowerPetal:"#3498db",cropLeaf:"#bdc3c7",cropFruit:["#ecf0f1","#95a5a6","#7f8c8d"]}};let d={...C.Spring},n={player:{x:0,y:0,w:b,h:b,dir:"down",isMoving:!1},keys:{w:!1,a:!1,s:!1,d:!1,ArrowUp:!1,ArrowLeft:!1,ArrowDown:!1,ArrowRight:!1," ":!1,Enter:!1},camera:{x:0,y:0},interactionTarget:null,isModalOpen:!1,lastTime:0,season:{current:0,timer:0},editor:{active:!1,tool:"tree",mouseX:0,mouseY:0},debug:{showCoords:!1}};const w=[{id:"house",x:-80,y:-300,w:160,h:140,type:"building",label:"My House",interactDist:60,collisionBox:{x:10,y:40,w:140,h:90},door:{x:70,y:130},content:`
            <h2>About Me</h2>
            <p>Hi! I'm <strong>Louis</strong>, I'm a full-stack web developer with a strong focus on web technologies.</p>
            <h3>Skills</h3>
            <ul>
                <li>JavaScript, TypeScript (React, Node.js, Angular, Backbone, ...)</li>
                <li>Ruby on Rails</li>
                <li>HTML, CSS</li>
                <li>Database Design (SQL, NoSQL)</li>
                <li>Cloud platform (AWS)</li>
            </ul>
        `},{id:"field1",x:100,y:0,w:150,h:150,type:"garden",label:"Projects Field",interactDist:80,collisionBox:{x:0,y:0,w:150,h:150},door:{x:75,y:150},content:`
            <h2>Projects Field</h2>
            <p>Here is what I've been growing lately:</p>

            <h3>üß¨ Cytobank</h3>
            <p>A cloud-based Flow Cytometry data analysis platform.</p>

            <h3>üîÅ Aldon Lifecycle Management</h3>
            <p>A Software Life Management tool on IBM i.</p>

            <h3>üßë‚Äçüíª Zowe Code Editor</h3>
            <p>A plug-in of Zowe running on IBM mainframe.</p>
        `},{id:"board",x:-250,y:-210,w:80,h:60,type:"sign",label:"Blog Board",interactDist:50,collisionBox:{x:10,y:10,w:60,h:50},door:{x:40,y:65},content:`
            <h2>Community Board (Blog)</h2>

            <h3>üìÖ Oct 20, 2023: Moving to VIM</h3>
            <p>Why I abandoned my mouse and how it changed my workflow forever.</p>

            <h3>üìÖ Sep 15, 2023: Canvas API 101</h3>
            <p>A tutorial on how to build exactly what you are looking at right now!</p>

            <h3>üìÖ Aug 01, 2023: burnout.js</h3>
            <p>Managing mental health in a fast-paced tech environment.</p>
        `},{id:"mailbox",x:130,y:-210,w:30,h:50,type:"mailbox",label:"Resume/Contact",interactDist:40,collisionBox:{x:0,y:0,w:30,h:50},door:{x:15,y:55},content:`
            <h2>Contact Me</h2>
            <p><strong>Email:</strong> louisgh.cn@gmail.com</p>
            <hr>
            <h3>Social Medias</h3>
            <p><strong>GitHub:</strong> github.com/louis-7</p>
            <p><strong>Dev.to:</strong> dev.to/louis7</p>
            <p><strong>LinkedIn:</strong> www.linkedin.com/in/louis360</p>
        `}];let g=[],m=[],O=[];function N(t,l,o){m.push({x:l,y:o,type:t,dir:"down",facing:t==="chicken"?"right":"left",frame:0,isMoving:!1,moveTimer:Math.random()*2e3})}function Q(){g=[],m=[],O=[],["cow","cow","chicken","chicken","chicken","horse","sheep","sheep"].forEach(l=>{let o=!1,r=0;for(;!o&&r<50;){let i,a;r<20?(i=150+Math.random()*400,a=-200+Math.random()*400):(i=Math.random()*(c.maxX-c.minX)+c.minX,a=Math.random()*(c.maxY-c.minY)+c.minY);let s=!1;const y=40;for(const f of w)if(i>f.x-y&&i<f.x+f.w+y&&a>f.y-y&&a<f.y+f.h+y){s=!0;break}s||(N(l,i,a),o=!0),r++}});for(let l=0;l<100;l++){const o=Math.random()*(c.maxX-c.minX)+c.minX,r=Math.random()*(c.maxY-c.minY)+c.minY;let i=!1;const a=30;for(const s of w)if(o>s.x-a&&o<s.x+s.w+a&&r>s.y-a&&r<s.y+s.h+a){i=!0;break}o>130&&o<570&&r>-220&&r<320&&(i=!0),!i&&g.push({x:o,y:r,type:Math.random()>.7?"rock":"tree"})}g.push({x:-150,y:-250,type:"tree"}),g.push({x:80,y:-250,type:"tree"}),g.push({x:-400,y:-200,type:"rock"})}function F(){n.season.current=(n.season.current+1)%L.length,n.season.timer=0,V()}function V(){const t=L[n.season.current];d={...C[t]},p&&(p.innerText=t),console.log("Season changed to "+t)}function K(){p&&p.addEventListener("click",F),Y.addEventListener("click",()=>{E.classList.toggle("minimized"),X.innerText=E.classList.contains("minimized")?"‚ñ∂":"‚ñº"}),u.addEventListener("click",()=>{n.editor.active=!n.editor.active,n.editor.active?(u.innerText="Disable Editing",u.classList.add("active"),P.style.display="grid"):(u.innerText="Enable Editing",u.classList.remove("active"),P.style.display="none")}),R.addEventListener("click",()=>{n.debug.showCoords=!n.debug.showCoords,R.classList.toggle("active"),R.innerText=n.debug.showCoords?"Hide Coords":"Show Coords"})}window.setTool=function(t){n.editor.tool=t,document.querySelectorAll("#editor-tools .tool-btn").forEach(l=>{l.outerHTML.includes(t)?l.classList.add("active"):l.classList.remove("active")})};window.exportMap=function(){const t=JSON.stringify({scenery:g,animals:m});navigator.clipboard.writeText(t).then(()=>{alert("Map data copied to clipboard! You can save this JSON.")}),console.log(t)};h.addEventListener("mousemove",t=>{const l=h.getBoundingClientRect();n.editor.mouseX=t.clientX-l.left,n.editor.mouseY=t.clientY-l.top});h.addEventListener("mousedown",t=>{if(!n.editor.active)return;const l=h.getBoundingClientRect(),o=t.clientX-l.left,r=t.clientY-l.top,i=Math.round(o+n.camera.x),a=Math.round(r+n.camera.y),s=30;if(n.editor.tool==="erase"){let y=g.findIndex(f=>Math.hypot(f.x-i,f.y-a)<s);y!==-1?g.splice(y,1):(y=m.findIndex(f=>Math.hypot(f.x-i,f.y-a)<s),y!==-1&&m.splice(y,1))}else["cow","chicken","horse","sheep"].includes(n.editor.tool)?N(n.editor.tool,i,a):g.push({x:i,y:a,type:n.editor.tool})});window.addEventListener("keydown",t=>{(n.keys.hasOwnProperty(t.key)||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&(n.keys[t.key]=!0),(t.key===" "||t.key==="Enter")&&!n.isModalOpen&&n.interactionTarget&&H(n.interactionTarget.content)});window.addEventListener("keyup",t=>{(n.keys.hasOwnProperty(t.key)||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&(n.keys[t.key]=!1)});const j=document.getElementById("btn-up"),z=document.getElementById("btn-down"),ee=document.getElementById("btn-left"),te=document.getElementById("btn-right"),le=document.getElementById("btn-action"),oe=document.getElementById("mobile-controls");("ontouchstart"in window||navigator.maxTouchPoints>0)&&(oe.style.display="block",M.innerText="Tap 'A' to Interact");const T=(t,l)=>{t.addEventListener("touchstart",o=>{o.preventDefault(),n.keys[l]=!0}),t.addEventListener("touchend",o=>{o.preventDefault(),n.keys[l]=!1})};T(j,"ArrowUp");T(z,"ArrowDown");T(ee,"ArrowLeft");T(te,"ArrowRight");le.addEventListener("touchstart",t=>{t.preventDefault(),!n.isModalOpen&&n.interactionTarget&&H(n.interactionTarget.content)});async function ie(){const t=w.find(l=>l.id==="board");if(t){t.content="<h2>Community Board (Blog)</h2><p>Loading articles...</p>";try{const o=await(await fetch("https://dev.to/api/articles?username=louis7")).json();let r="<h2>Community Board (Blog)</h2>";o.forEach(i=>{const a=new Date(i.published_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});r+=`
                <div class="blog-item" style="margin-bottom: 20px; border-bottom: 1px dashed #8b4513; padding-bottom: 10px;">
                    <h3 style="margin-bottom: 8px; font-size: 14px;">
                        <a href="${i.url}" target="_blank" style="color: #d35400; text-decoration: none;">${i.title}</a>
                    </h3>
                    <p style="font-size: 10px; color: #555; margin: 0;">
                        ‚è≥ ${i.reading_time_minutes} min ¬∑ üìÖ ${a} ¬∑ ‚ù§Ô∏è ${i.public_reactions_count}
                    </p>
                </div>
            `}),t.content=r}catch(l){console.error(l),t.content=`
            <h2>Community Board (Blog)</h2>
            <p>Failed to load blogs.</p>
            <p>Check out <a href="https://dev.to/louis7" target="_blank">dev.to/louis7</a></p>
        `}}}async function ne(){I(),window.addEventListener("resize",I),Q();const t=new Promise(s=>setTimeout(s,2e3)),l=new Promise(s=>setTimeout(s,5e3)),o=document.fonts.ready.catch(s=>console.warn("Font load warning:",s)),r=ie().catch(s=>console.warn("Blog load warning:",s)),i=Promise.all([o,r]);await Promise.all([t,Promise.race([i,l])]),n.player.x=0,n.player.y=-150;const a=document.getElementById("loading-screen");a.classList.add("fade-out"),requestAnimationFrame(W),setTimeout(()=>{a.style.display="none"},1e3)}function I(){h.width=window.innerWidth,h.height=window.innerHeight,e.imageSmoothingEnabled=!1}function re(t){if(n.isModalOpen)return;n.season.timer+=t,n.season.timer>=G&&F(),m.forEach(i=>{if(i.moveTimer-=t,i.isMoving)if(i.moveTimer<=0)i.isMoving=!1,i.frame=0,i.moveTimer=1e3+Math.random()*2e3;else{let a=0,s=0;i.dir==="up"&&(s=-k),i.dir==="down"&&(s=k),i.dir==="left"&&(a=-k,i.facing="left"),i.dir==="right"&&(a=k,i.facing="right");let y=i.x+a,f=i.y+s;if((y<c.minX+20||y>c.maxX-20)&&(y=i.x),(f<c.minY+20||f>c.maxY-20)&&(f=i.y),_({x:y-10,y:f-5,w:20,h:10})){y=i.x,f=i.y;const x=["up","down","left","right"];i.dir=x[Math.floor(Math.random()*x.length)]}i.x=y,i.y=f,i.frame=(i.frame+t*.01)%2}else if(i.moveTimer<=0){i.isMoving=!0,i.moveTimer=2e3+Math.random()*3e3;const a=["up","down","left","right"];i.dir=a[Math.floor(Math.random()*a.length)]}});const l=n.player;let o=0,r=0;if((n.keys.w||n.keys.ArrowUp)&&(r=-S),(n.keys.s||n.keys.ArrowDown)&&(r=S),(n.keys.a||n.keys.ArrowLeft)&&(o=-S),(n.keys.d||n.keys.ArrowRight)&&(o=S),o!==0&&r!==0&&(o*=.707,r*=.707),o!==0||r!==0){l.isMoving=!0,Math.abs(o)>Math.abs(r)?l.dir=o>0?"right":"left":l.dir=r>0?"down":"up";let i=l.x+o,a=l.y+r;i<c.minX&&(i=l.x),i>c.maxX-l.w&&(i=l.x),a<c.minY&&(a=l.y),a>c.maxY-l.h&&(a=l.y),B(i,l.y)||(l.x=i),B(l.x,a)||(l.y=a)}else l.isMoving=!1;ae(),n.camera.x=l.x-h.width/2+l.w/2,n.camera.y=l.y-h.height/2+l.h/2}function _(t){for(let l of w){const o=l.collisionBox,r=l.x+o.x,i=l.y+o.y;if(t.x<r+o.w&&t.x+t.w>r&&t.y<i+o.h&&t.y+t.h>i)return!0}return!1}function B(t,l){const o={x:t,y:l+b/2,w:b,h:b/2};return _(o)}function ae(){const t=n.player,l={x:t.x+t.w/2,y:t.y+t.h/2};let o=null,r=1/0;for(let i of w){const a={x:i.x+i.door.x,y:i.y+i.door.y},s=Math.hypot(l.x-a.x,l.y-a.y);s<i.interactDist&&s<r&&(r=s,o=i)}n.interactionTarget=o,o?M.style.display="block":M.style.display="none"}function H(t){n.isModalOpen=!0,Z.innerHTML=t,v.style.display="flex",Object.keys(n.keys).forEach(l=>n.keys[l]=!1)}function U(){n.isModalOpen=!1,v.style.display="none"}J.addEventListener("click",U);v.addEventListener("click",t=>{t.target===v&&U()});function ce(){e.fillStyle="#111",e.fillRect(0,0,h.width,h.height),e.save(),e.translate(-n.camera.x,-n.camera.y),fe();const t=[...g.map(l=>({...l,drawType:"scenery",z:l.y})),...O.map(l=>({...l,drawType:"fence",z:l.y+10})),...w.map(l=>({...l,drawType:"zone",z:l.y+l.collisionBox.h+l.collisionBox.y})),...m.map(l=>({...l,drawType:"animal",z:l.y+2})),{drawType:"player",z:n.player.y+n.player.h}];if(t.sort((l,o)=>l.z-o.z),t.forEach(l=>{l.drawType==="scenery"&&A(l),l.drawType==="fence"&&de(l),l.drawType==="zone"&&ye(l),l.drawType==="animal"&&D(l),l.drawType==="player"&&he()}),n.interactionTarget){const l=n.interactionTarget,o=l.x+l.door.x,r=l.y+l.door.y-30;e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2;const i=Math.sin(Date.now()/200)*5;e.beginPath(),e.moveTo(o-10,r+i),e.lineTo(o+10,r+i),e.lineTo(o,r+10+i),e.closePath(),e.fill(),e.stroke()}if(n.editor.active&&n.editor.tool!=="erase"){const l=n.editor.mouseX+n.camera.x,o=n.editor.mouseY+n.camera.y;e.globalAlpha=.5,["cow","chicken","horse","sheep"].includes(n.editor.tool)?D({x:l,y:o,type:n.editor.tool,isMoving:!1,frame:0}):A({x:l,y:o,type:n.editor.tool}),e.globalAlpha=1,e.strokeStyle="white",e.lineWidth=2,e.beginPath(),e.arc(l,o,20,0,Math.PI*2),e.stroke()}else if(n.editor.active&&n.editor.tool==="erase"){const l=n.editor.mouseX+n.camera.x,o=n.editor.mouseY+n.camera.y;e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.arc(l,o,15,0,Math.PI*2),e.moveTo(l-10,o-10),e.lineTo(l+10,o+10),e.moveTo(l+10,o-10),e.lineTo(l-10,o+10),e.stroke()}n.debug.showCoords&&se(),e.restore()}function se(){e.save(),e.lineWidth=1,e.font="10px monospace",e.strokeStyle="rgba(255, 0, 0, 0.5)",e.beginPath(),e.moveTo(c.minX,0),e.lineTo(c.maxX,0),e.stroke(),e.strokeStyle="rgba(0, 0, 255, 0.5)",e.beginPath(),e.moveTo(0,c.minY),e.lineTo(0,c.maxY),e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.textAlign="center",e.textBaseline="top";for(let t=Math.ceil(c.minX/100)*100;t<=c.maxX;t+=100)t!==0&&(e.beginPath(),e.moveTo(t,-5),e.lineTo(t,5),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fillText(t.toString(),t,8));e.textAlign="left",e.textBaseline="middle";for(let t=Math.ceil(c.minY/100)*100;t<=c.maxY;t+=100)t!==0&&(e.beginPath(),e.moveTo(-5,t),e.lineTo(5,t),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fillText(t.toString(),8,t));e.fillStyle="yellow",e.fillText("(0,0)",5,5),e.restore()}function fe(){e.fillStyle=d.water,e.fillRect(n.camera.x,n.camera.y,h.width,h.height);const t=Date.now();e.fillStyle="rgba(255, 255, 255, 0.4)";const l=Math.floor(n.camera.x/50)*50,o=Math.floor(n.camera.y/50)*50,r=h.width+100,i=h.height+100;for(let a=l;a<l+r;a+=50)for(let s=o;s<o+i;s+=50){const y=Math.sin(a*99+t/1e3)*20,f=Math.cos(s*88+t/1e3)*20;if(a+y<c.minX||a+y>c.maxX||s+f<c.minY||s+f>c.maxY){const x=(Math.sin(t/500+a)+1)*2+1;e.fillRect(a+y,s+f,x*2,x)}}e.fillStyle=d.grass,e.fillRect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),e.fillStyle=d.grassDark;for(let a=c.minX;a<c.maxX;a+=50)for(let s=c.minY;s<c.maxY;s+=50)Math.abs(a*s)%7===0&&(e.fillRect(a+10,s+10,5,5),e.fillRect(a+15,s+5,5,5))}function de(t){e.fillStyle=d.woodDark,e.fillRect(t.x,t.y-15,8,20),e.fillStyle=d.wood,e.fillRect(t.x-10,t.y-10,42,4),e.fillRect(t.x-10,t.y-2,42,4)}function A(t){t.type==="tree"?(e.fillStyle=d.woodDark,e.fillRect(t.x-8,t.y-10,16,30),e.fillStyle=d.treeLight,e.beginPath(),e.arc(t.x,t.y-30,25,0,Math.PI*2),e.fill(),e.fillStyle=d.treeDark,e.beginPath(),e.arc(t.x-10,t.y-35,15,0,Math.PI*2),e.fill()):t.type==="rock"?(e.fillStyle="#7f8c8d",e.beginPath(),e.arc(t.x,t.y,10,0,Math.PI*2),e.fill(),e.fillStyle="#95a5a6",e.fillRect(t.x-5,t.y-8,5,5)):t.type==="flower"?(e.fillStyle=d.flowerStem,e.fillRect(t.x-1,t.y,2,8),e.fillStyle=d.flowerPetal,e.beginPath(),e.arc(t.x,t.y,4,0,Math.PI*2),e.fill(),e.fillStyle="#f1c40f",e.beginPath(),e.arc(t.x,t.y,1.5,0,Math.PI*2),e.fill()):t.type==="plant"&&(e.fillStyle=d.cropLeaf,e.beginPath(),e.arc(t.x,t.y-4,6,0,Math.PI*2),e.fill(),e.fillStyle=d.cropFruit[0],e.beginPath(),e.arc(t.x,t.y-8,3,0,Math.PI*2),e.fill())}function D(t){const l=t.x,o=t.y,r=q[t.type],i=t.isMoving&&Math.floor(t.frame)===1?2:0;e.save();let a=!1;t.type==="chicken"?t.facing==="left"&&(a=!0):t.facing==="right"&&(a=!0),a&&(e.translate(l,o),e.scale(-1,1),e.translate(-l,-o)),e.fillStyle="rgba(0,0,0,0.2)",e.beginPath(),e.ellipse(l,o+4,10,5,0,0,Math.PI*2),e.fill(),t.type==="cow"?(e.fillStyle=r.body,e.fillRect(l-14,o-20,28,20),e.fillStyle=r.spots,e.fillRect(l-8,o-18,10,8),e.fillRect(l+6,o-14,6,6),e.fillStyle=r.body,e.fillRect(l-18,o-26,16,16),e.fillStyle="#d7ccc8",e.fillRect(l-18,o-28,4,4),e.fillRect(l-6,o-28,4,4),e.fillStyle=r.body,e.fillRect(l-20,o-22,2,4),e.fillRect(l-2,o-22,2,4),e.fillStyle=r.snout,e.fillRect(l-18,o-14,16,6),e.fillStyle="#000",e.fillRect(l-16,o-20,2,2),e.fillRect(l-8,o-20,2,2),e.fillStyle=r.body,e.fillRect(l-12,o,6,6+i),e.fillRect(l+6,o,6,6-i),e.fillStyle=r.body,e.fillRect(l+14,o-18,2,10),e.fillStyle=r.spots,e.fillRect(l+13,o-8,4,4)):t.type==="chicken"?(e.fillStyle=r.body,e.fillRect(l-6,o-10,12,10),e.fillStyle=r.body,e.fillRect(l-8,o-12,4,6),e.fillStyle="#e0e0e0",e.fillRect(l-2,o-8,6,4),e.fillStyle=r.body,e.fillRect(l+2,o-14,6,6),e.fillStyle=r.comb,e.fillRect(l+3,o-16,4,2),e.fillRect(l+4,o-10,2,2),e.fillStyle=r.beak,e.fillRect(l+8,o-12,2,2),e.fillStyle="#000",e.fillRect(l+6,o-13,1,1),e.fillStyle="#e67e22",e.fillRect(l-2,o,2,4+i),e.fillRect(l+4,o,2,4-i)):t.type==="horse"?(e.fillStyle=r.body,e.fillRect(l-14,o-22,30,18),e.fillStyle=r.body,e.fillRect(l-16,o-30,10,14),e.fillStyle=r.body,e.fillRect(l-22,o-32,14,10),e.fillStyle=r.mane,e.fillRect(l-6,o-32,4,16),e.fillRect(l-16,o-34,4,4),e.fillStyle=r.body,e.fillRect(l-14,o-34,2,4),e.fillRect(l-8,o-34,2,4),e.fillStyle=r.snout,e.fillRect(l-24,o-28,4,6),e.fillStyle="#000",e.fillRect(l-18,o-28,2,2),e.fillStyle=r.body,e.fillRect(l-12,o-4,6,10+i),e.fillRect(l+8,o-4,6,10-i),e.fillStyle=r.mane,e.fillRect(l+16,o-20,4,12)):t.type==="sheep"&&(e.fillStyle=r.legs,e.fillRect(l-8,o+2,4,6+i),e.fillRect(l+4,o+2,4,6-i),e.fillStyle=r.body,e.beginPath(),e.arc(l,o-8,10,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l-6,o-6,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l+6,o-6,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l,o-12,9,0,Math.PI*2),e.fill(),e.fillStyle=r.head,e.fillRect(l-14,o-16,10,10),e.fillRect(l-16,o-14,2,4),e.fillRect(l-4,o-14,2,4),e.fillStyle=r.body,e.fillRect(l-14,o-18,10,4),e.fillStyle="#fff",e.fillRect(l-12,o-14,2,2)),e.restore()}function ye(t){if(t.type==="building")e.fillStyle="rgba(0,0,0,0.2)",e.fillRect(t.x+10,t.y+100,140,40),e.fillStyle="#f5d76e",e.fillRect(t.x+10,t.y+40,140,90),e.fillStyle=d.wood,e.fillRect(t.x+10,t.y+40,140,10),e.fillRect(t.x+10,t.y+120,140,10),e.fillRect(t.x+10,t.y+40,10,90),e.fillRect(t.x+140,t.y+40,10,90),e.fillStyle=d.roof,e.beginPath(),e.moveTo(t.x-10,t.y+40),e.lineTo(t.x+80,t.y-20),e.lineTo(t.x+170,t.y+40),e.fill(),e.fillStyle=d.woodDark,e.fillRect(t.x+60,t.y+80,40,50),e.fillStyle="#f39c12",e.fillRect(t.x+90,t.y+105,4,4),e.fillStyle="#85c1e9",e.fillRect(t.x+25,t.y+60,30,30),e.fillStyle=d.wood,e.fillRect(t.x+38,t.y+60,4,30),e.fillRect(t.x+25,t.y+73,30,4);else if(t.type==="garden"){e.fillStyle=d.dirt,e.fillRect(t.x,t.y,t.w,t.h),e.strokeStyle="rgba(0,0,0,0.1)",e.beginPath();for(let l=0;l<=t.w;l+=30)e.moveTo(t.x+l,t.y),e.lineTo(t.x+l,t.y+t.h);for(let l=0;l<=t.h;l+=30)e.moveTo(t.x,t.y+l),e.lineTo(t.x+t.w,t.y+l);e.stroke();for(let l=15;l<t.w;l+=30)for(let o=15;o<t.h;o+=30){e.fillStyle=d.cropLeaf,e.beginPath(),e.arc(t.x+l,t.y+o,10,0,Math.PI*2),e.fill();const r=d.cropFruit,i=r[(l+o)%r.length];e.fillStyle=i,e.beginPath(),e.arc(t.x+l,t.y+o-5,4,0,Math.PI*2),e.fill()}}else t.type==="sign"?(e.fillStyle=d.wood,e.fillRect(t.x+15,t.y+30,5,20),e.fillRect(t.x+60,t.y+30,5,20),e.fillStyle=d.woodDark,e.fillRect(t.x,t.y,t.w,40),e.fillStyle="#fff",e.fillRect(t.x+5,t.y+5,t.w-10,30),e.fillStyle="#333",e.fillRect(t.x+10,t.y+15,t.w-20,2),e.fillRect(t.x+10,t.y+25,t.w-20,2)):t.type==="mailbox"&&(e.fillStyle="#bdc3c7",e.fillRect(t.x+12,t.y+20,6,30),e.fillStyle="#34495e",e.beginPath(),e.arc(t.x+15,t.y+10,15,Math.PI,0),e.lineTo(t.x+30,t.y+20),e.lineTo(t.x,t.y+20),e.fill(),e.fillStyle="#c0392b",e.fillRect(t.x+28,t.y+5,2,10),e.fillRect(t.x+28,t.y+5,8,5))}function he(){const t=n.player,l=t.x,o=t.y;if(e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(l+16,o+30,10,4,0,0,Math.PI*2),e.fill(),e.fillStyle="#2c3e50",t.isMoving){const r=Math.sin(Date.now()/100)*5;e.fillRect(l+8,o+20+r,6,12),e.fillRect(l+18,o+20-r,6,12)}else e.fillRect(l+8,o+20,6,12),e.fillRect(l+18,o+20,6,12);e.fillStyle="#e74c3c",e.fillRect(l+6,o+12,20,14),e.fillStyle="#f1c40f",e.fillRect(l+8,o,16,14),e.fillStyle="#2980b9",e.fillRect(l+6,o-4,20,6),e.fillRect(l+8,o-8,16,6),e.fillStyle="black",t.dir==="down"?(e.fillRect(l+12,o+6,2,2),e.fillRect(l+18,o+6,2,2)):t.dir==="right"?e.fillRect(l+18,o+6,2,2):t.dir==="left"&&e.fillRect(l+12,o+6,2,2),e.fillStyle="white",e.font='10px "Press Start 2P"',e.fillText("Me",l+6,o-15)}function W(t){const l=t-n.lastTime;n.lastTime=t,re(l),ce(),requestAnimationFrame(W)}ne();
