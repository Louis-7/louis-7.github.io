import"./modulepreload-polyfill-B5Qt9EMX.js";const h=document.getElementById("gameCanvas"),e=h.getContext("2d"),P=document.getElementById("interaction-prompt"),M=document.getElementById("modal-overlay"),K=document.getElementById("modal-body"),V=document.getElementById("close-btn");let A,g,u,v,I,_,N;const j=`
<div id="settings-panel">
    <div class="panel-header" id="panel-header">
        <span>‚öôÔ∏è MENU</span>
        <span id="toggle-icon">‚ñº</span>
    </div>
    <div class="panel-body">
        <div class="control-group">
            <span class="control-label">Current Season</span>
            <button class="pixel-btn" id="season-btn">SPRING</button>
        </div>
        <div class="control-group">
            <span class="control-label">Map Editor</span>
            <button class="pixel-btn" id="editor-toggle-btn">Enable Editing</button>
            <div id="editor-tools">
                <button class="tool-btn active" onclick="setTool('tree')">üå≤</button>
                <button class="tool-btn" onclick="setTool('rock')">ü™®</button>
                <button class="tool-btn" onclick="setTool('flower')">üå∏</button>
                <button class="tool-btn" onclick="setTool('plant')">üåø</button>
                <button class="tool-btn" onclick="setTool('cow')">üêÑ</button>
                <button class="tool-btn" onclick="setTool('chicken')">üêî</button>
                <button class="tool-btn" onclick="setTool('horse')">üêé</button>
                <button class="tool-btn" onclick="setTool('sheep')">üêè</button>
                <button class="tool-btn" onclick="setTool('erase')">‚ùå</button>
            </div>
        </div>
        <div class="control-group">
            <button class="pixel-btn" onclick="exportMap()" style="font-size: 8px;">üíæ Copy Map JSON</button>
        </div>
        <div class="control-group">
            <span class="control-label">Debug</span>
            <button class="pixel-btn" id="debug-toggle-btn">Show Coords</button>
        </div>
    </div>
</div>`;window.openSesame=function(){if(document.getElementById("settings-panel"))return;const t=document.getElementById("ui-layer"),l=document.getElementById("interaction-prompt"),o=document.createElement("div");o.innerHTML=j,t.insertBefore(o.firstElementChild,l),A=document.getElementById("settings-panel"),g=document.getElementById("season-btn"),u=document.getElementById("editor-toggle-btn"),v=document.getElementById("debug-toggle-btn"),I=document.getElementById("editor-tools"),_=document.getElementById("panel-header"),N=document.getElementById("toggle-icon"),oe(),g&&(g.innerText=B[i.season.current]),console.log("Developer Mode Enabled")};const k=4,b=32,z=6e4,B=["Spring","Summer","Fall","Winter"],c={minX:-800,maxX:800,minY:-600,maxY:600},R=.5,ee={cow:{body:"#e3dac9",spots:"#5d4037",snout:"#f8bbd0"},chicken:{body:"#ffffff",comb:"#c0392b",beak:"#f1c40f"},horse:{body:"#a1887f",mane:"#5d4037",snout:"#d7ccc8"},sheep:{body:"#ecf0f1",head:"#34495e",legs:"#34495e"}},F={Spring:{grass:"#76c758",grassDark:"#66b04a",dirt:"#8b5e3c",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#c0392b",water:"#3498db",treeLight:"#2ecc71",treeDark:"#27ae60",flowerStem:"#27ae60",flowerPetal:"#e74c3c",cropLeaf:"#2ecc71",cropFruit:["#e74c3c","#f1c40f","#9b59b6"]},Summer:{grass:"#53c738",grassDark:"#41a02a",dirt:"#8b5e3c",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#c0392b",water:"#3498db",treeLight:"#2ecc71",treeDark:"#27ae60",flowerStem:"#27ae60",flowerPetal:"#f39c12",cropLeaf:"#27ae60",cropFruit:["#c0392b","#e67e22","#f39c12"]},Fall:{grass:"#d68910",grassDark:"#b9770e",dirt:"#6e4c30",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#922b21",water:"#2e86c1",treeLight:"#e67e22",treeDark:"#d35400",flowerStem:"#8b5e3c",flowerPetal:"#8e44ad",cropLeaf:"#d35400",cropFruit:["#e67e22","#8e44ad","#c0392b"]},Winter:{grass:"#ecf0f1",grassDark:"#bdc3c7",dirt:"#95a5a6",wood:"#7f8c8d",woodDark:"#555",roof:"#2c3e50",water:"#aed6f1",treeLight:"#dfe6e9",treeDark:"#b2babb",flowerStem:"#95a5a6",flowerPetal:"#3498db",cropLeaf:"#bdc3c7",cropFruit:["#ecf0f1","#95a5a6","#7f8c8d"]}};let d={...F.Spring},i={player:{x:0,y:0,w:b,h:b,dir:"down",isMoving:!1},keys:{w:!1,a:!1,s:!1,d:!1,ArrowUp:!1,ArrowLeft:!1,ArrowDown:!1,ArrowRight:!1," ":!1,Enter:!1},camera:{x:0,y:0},interactionTarget:null,isModalOpen:!1,lastTime:0,season:{current:0,timer:0},editor:{active:!1,tool:"tree",mouseX:0,mouseY:0},debug:{showCoords:!1}};const w=[{id:"house",x:-80,y:-300,w:160,h:140,type:"building",label:"My House",interactDist:60,collisionBox:{x:10,y:40,w:140,h:90},door:{x:70,y:130},content:`
            <h2>About Me</h2>
            <p>Hi! I'm <strong>Louis</strong>, I'm a full-stack web developer with a strong focus on web technologies.</p>
            <h3>Skills</h3>
            <ul>
                <li>JavaScript, TypeScript (React, Node.js, Angular, Backbone, ...)</li>
                <li>Ruby on Rails</li>
                <li>HTML, CSS</li>
                <li>Database Design (SQL, NoSQL)</li>
                <li>Cloud platform (AWS)</li>
            </ul>
        `},{id:"field1",x:100,y:0,w:150,h:150,type:"garden",label:"Projects Field",interactDist:80,collisionBox:{x:0,y:0,w:150,h:150},door:{x:75,y:150},content:`
            <h2>Projects Field</h2>
            <p>Here is what I've been growing lately:</p>

            <h3>
                <a href="https://github.com/Snap-Mind/snap-mind" target="_blank" style="color: #d35400; text-decoration: none;">üß† SnapMind</a>
            </h3>
            <p>A cross-platform desktop AI assistant that lets you translate, rewrite, summarize, and brainstorm with just a hotkey.</p>

            <h3>üß¨ Cytobank</h3>
            <p>A cloud-based Flow Cytometry data analysis platform.</p>

            <h3>üîÅ Aldon Lifecycle Management</h3>
            <p>A Software Life Management tool on IBM i.</p>

            <h3>üßë‚Äçüíª Zowe Code Editor</h3>
            <p>A plug-in of Zowe running on IBM mainframe.</p>
        `},{id:"board",x:-250,y:-210,w:80,h:60,type:"sign",label:"Blog Board",interactDist:50,collisionBox:{x:10,y:10,w:60,h:50},door:{x:40,y:65},content:`
            <h2>Community Board (Blog)</h2>

            <h3>üìÖ Fetching</h3>
            <p>Loading my blogs...</p>
        `},{id:"mailbox",x:130,y:-210,w:30,h:50,type:"mailbox",label:"Resume/Contact",interactDist:40,collisionBox:{x:0,y:0,w:30,h:50},door:{x:15,y:55},content:`
            <h2>Contact Me</h2>
            <p><strong>Email:</strong> <a href="mailto:louisgh.cn@gmail.com" style="color: #d35400;">louisgh.cn@gmail.com</a></p>
            <hr>
            <h3>Social Medias</h3>
            <p><strong>GitHub:</strong> <a href="https://github.com/louis-7" target="_blank" style="color: #d35400;">github.com/louis-7</a></p>
            <p><strong>Dev.to:</strong> <a href="https://dev.to/louis7" target="_blank" style="color: #d35400;">dev.to/louis7</a></p>
            <p><strong>LinkedIn:</strong> <a href="https://www.linkedin.com/in/louis360" target="_blank" style="color: #d35400;">linkedin.com/in/louis360</a></p>
        `}];let p=[],m=[],H=[];function U(t,l,o){m.push({x:l,y:o,type:t,dir:"down",facing:t==="chicken"?"right":"left",frame:0,isMoving:!1,moveTimer:Math.random()*2e3})}function te(){p=[],m=[],H=[],["cow","cow","chicken","chicken","chicken","horse","sheep","sheep"].forEach(l=>{let o=!1,r=0;for(;!o&&r<50;){let n,s;r<20?(n=150+Math.random()*400,s=-200+Math.random()*400):(n=Math.random()*(c.maxX-c.minX)+c.minX,s=Math.random()*(c.maxY-c.minY)+c.minY);let a=!1;const y=40;for(const f of w)if(n>f.x-y&&n<f.x+f.w+y&&s>f.y-y&&s<f.y+f.h+y){a=!0;break}a||(U(l,n,s),o=!0),r++}});for(let l=0;l<100;l++){const o=Math.random()*(c.maxX-c.minX)+c.minX,r=Math.random()*(c.maxY-c.minY)+c.minY;let n=!1;const s=30;for(const a of w)if(o>a.x-s&&o<a.x+a.w+s&&r>a.y-s&&r<a.y+a.h+s){n=!0;break}o>130&&o<570&&r>-220&&r<320&&(n=!0),!n&&p.push({x:o,y:r,type:Math.random()>.7?"rock":"tree"})}p.push({x:-150,y:-250,type:"tree"}),p.push({x:80,y:-250,type:"tree"}),p.push({x:-400,y:-200,type:"rock"})}function Z(){i.season.current=(i.season.current+1)%B.length,i.season.timer=0,le()}function le(){const t=B[i.season.current];d={...F[t]},g&&(g.innerText=t),console.log("Season changed to "+t)}function oe(){g&&g.addEventListener("click",Z),_.addEventListener("click",()=>{A.classList.toggle("minimized"),N.innerText=A.classList.contains("minimized")?"‚ñ∂":"‚ñº"}),u.addEventListener("click",()=>{i.editor.active=!i.editor.active,i.editor.active?(u.innerText="Disable Editing",u.classList.add("active"),I.style.display="grid"):(u.innerText="Enable Editing",u.classList.remove("active"),I.style.display="none")}),v.addEventListener("click",()=>{i.debug.showCoords=!i.debug.showCoords,v.classList.toggle("active"),v.innerText=i.debug.showCoords?"Hide Coords":"Show Coords"})}window.setTool=function(t){i.editor.tool=t,document.querySelectorAll("#editor-tools .tool-btn").forEach(l=>{l.outerHTML.includes(t)?l.classList.add("active"):l.classList.remove("active")})};window.exportMap=function(){const t=JSON.stringify({scenery:p,animals:m});navigator.clipboard.writeText(t).then(()=>{alert("Map data copied to clipboard! You can save this JSON.")}),console.log(t)};h.addEventListener("mousemove",t=>{const l=h.getBoundingClientRect();i.editor.mouseX=t.clientX-l.left,i.editor.mouseY=t.clientY-l.top});h.addEventListener("mousedown",t=>{if(!i.editor.active)return;const l=h.getBoundingClientRect(),o=t.clientX-l.left,r=t.clientY-l.top,n=Math.round(o+i.camera.x),s=Math.round(r+i.camera.y),a=30;if(i.editor.tool==="erase"){let y=p.findIndex(f=>Math.hypot(f.x-n,f.y-s)<a);y!==-1?p.splice(y,1):(y=m.findIndex(f=>Math.hypot(f.x-n,f.y-s)<a),y!==-1&&m.splice(y,1))}else["cow","chicken","horse","sheep"].includes(i.editor.tool)?U(i.editor.tool,n,s):p.push({x:n,y:s,type:i.editor.tool})});window.addEventListener("keydown",t=>{if((i.keys.hasOwnProperty(t.key)||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&(i.keys[t.key]=!0),(t.key==="Escape"||t.key===" ")&&i.isModalOpen){T();return}(t.key===" "||t.key==="Enter")&&!i.isModalOpen&&i.interactionTarget&&G(i.interactionTarget.content)});window.addEventListener("keyup",t=>{(i.keys.hasOwnProperty(t.key)||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&(i.keys[t.key]=!1)});const S=document.getElementById("joystick"),W=document.getElementById("joystick-knob"),ie=document.getElementById("btn-action"),ne=document.getElementById("btn-close"),re=document.getElementById("mobile-controls");("ontouchstart"in window||navigator.maxTouchPoints>0)&&(re.style.display="block",P.innerText="Tap 'A' to Interact");let D=!1,E={x:0,y:0};const L=35;function J(t,l){const o=S.getBoundingClientRect();E={x:o.left+o.width/2,y:o.top+o.height/2};let r=t-E.x,n=l-E.y;const s=Math.sqrt(r*r+n*n);s>L&&(r=r/s*L,n=n/s*L),W.style.transform=`translate(calc(-50% + ${r}px), calc(-50% + ${n}px))`,i.keys.ArrowUp=!1,i.keys.ArrowDown=!1,i.keys.ArrowLeft=!1,i.keys.ArrowRight=!1;const a=15;s>a&&(n<-a*.5&&(i.keys.ArrowUp=!0),n>a*.5&&(i.keys.ArrowDown=!0),r<-a*.5&&(i.keys.ArrowLeft=!0),r>a*.5&&(i.keys.ArrowRight=!0))}function $(){D=!1,W.style.transform="translate(-50%, -50%)",i.keys.ArrowUp=!1,i.keys.ArrowDown=!1,i.keys.ArrowLeft=!1,i.keys.ArrowRight=!1}S.addEventListener("touchstart",t=>{t.preventDefault(),D=!0;const l=t.touches[0];J(l.clientX,l.clientY)});S.addEventListener("touchmove",t=>{if(t.preventDefault(),D){const l=t.touches[0];J(l.clientX,l.clientY)}});S.addEventListener("touchend",t=>{t.preventDefault(),$()});S.addEventListener("touchcancel",t=>{t.preventDefault(),$()});ie.addEventListener("touchstart",t=>{t.preventDefault(),!i.isModalOpen&&i.interactionTarget&&G(i.interactionTarget.content)});ne.addEventListener("touchstart",t=>{t.preventDefault(),i.isModalOpen&&T()});async function se(){const t=w.find(l=>l.id==="board");if(t){t.content="<h2>Community Board (Blog)</h2><p>Loading articles...</p>";try{const o=await(await fetch("https://dev.to/api/articles?username=louis7")).json();let r="<h2>Community Board (Blog)</h2>";o.forEach(n=>{const s=new Date(n.published_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});r+=`
                <div class="blog-item" style="margin-bottom: 20px; border-bottom: 1px dashed #8b4513; padding-bottom: 10px;">
                    <h3 style="margin-bottom: 8px; font-size: 14px;">
                        <a href="${n.url}" target="_blank" style="color: #d35400; text-decoration: none;">${n.title}</a>
                    </h3>
                    <p style="font-size: 10px; color: #555; margin: 0;">
                        ‚è≥ ${n.reading_time_minutes} min ¬∑ üìÖ ${s} ¬∑ ‚ù§Ô∏è ${n.public_reactions_count}
                    </p>
                </div>
            `}),t.content=r}catch(l){console.error(l),t.content=`
            <h2>Community Board (Blog)</h2>
            <p>Failed to load blogs.</p>
            <p>Check out <a href="https://dev.to/louis7" target="_blank">dev.to/louis7</a></p>
        `}}}async function ae(){Y(),window.addEventListener("resize",Y),te();const t=new Promise(a=>setTimeout(a,2e3)),l=new Promise(a=>setTimeout(a,5e3)),o=document.fonts.ready.catch(a=>console.warn("Font load warning:",a)),r=se().catch(a=>console.warn("Blog load warning:",a)),n=Promise.all([o,r]);await Promise.all([t,Promise.race([n,l])]),i.player.x=0,i.player.y=-150;const s=document.getElementById("loading-screen");s.classList.add("fade-out"),requestAnimationFrame(Q),setTimeout(()=>{s.style.display="none"},1e3)}function Y(){h.width=window.innerWidth,h.height=window.innerHeight,e.imageSmoothingEnabled=!1}function ce(t){if(i.isModalOpen)return;i.season.timer+=t,i.season.timer>=z&&Z(),m.forEach(n=>{if(n.moveTimer-=t,n.isMoving)if(n.moveTimer<=0)n.isMoving=!1,n.frame=0,n.moveTimer=1e3+Math.random()*2e3;else{let s=0,a=0;n.dir==="up"&&(a=-R),n.dir==="down"&&(a=R),n.dir==="left"&&(s=-R,n.facing="left"),n.dir==="right"&&(s=R,n.facing="right");let y=n.x+s,f=n.y+a;if((y<c.minX+20||y>c.maxX-20)&&(y=n.x),(f<c.minY+20||f>c.maxY-20)&&(f=n.y),q({x:y-10,y:f-5,w:20,h:10})){y=n.x,f=n.y;const x=["up","down","left","right"];n.dir=x[Math.floor(Math.random()*x.length)]}n.x=y,n.y=f,n.frame=(n.frame+t*.01)%2}else if(n.moveTimer<=0){n.isMoving=!0,n.moveTimer=2e3+Math.random()*3e3;const s=["up","down","left","right"];n.dir=s[Math.floor(Math.random()*s.length)]}});const l=i.player;let o=0,r=0;if((i.keys.w||i.keys.ArrowUp)&&(r=-k),(i.keys.s||i.keys.ArrowDown)&&(r=k),(i.keys.a||i.keys.ArrowLeft)&&(o=-k),(i.keys.d||i.keys.ArrowRight)&&(o=k),o!==0&&r!==0&&(o*=.707,r*=.707),o!==0||r!==0){l.isMoving=!0,Math.abs(o)>Math.abs(r)?l.dir=o>0?"right":"left":l.dir=r>0?"down":"up";let n=l.x+o,s=l.y+r;n<c.minX&&(n=l.x),n>c.maxX-l.w&&(n=l.x),s<c.minY&&(s=l.y),s>c.maxY-l.h&&(s=l.y),X(n,l.y)||(l.x=n),X(l.x,s)||(l.y=s)}else l.isMoving=!1;fe(),i.camera.x=l.x-h.width/2+l.w/2,i.camera.y=l.y-h.height/2+l.h/2}function q(t){for(let l of w){const o=l.collisionBox,r=l.x+o.x,n=l.y+o.y;if(t.x<r+o.w&&t.x+t.w>r&&t.y<n+o.h&&t.y+t.h>n)return!0}return!1}function X(t,l){const o={x:t,y:l+b/2,w:b,h:b/2};return q(o)}function fe(){const t=i.player,l={x:t.x+t.w/2,y:t.y+t.h/2};let o=null,r=1/0;for(let n of w){const s={x:n.x+n.door.x,y:n.y+n.door.y},a=Math.hypot(l.x-s.x,l.y-s.y);a<n.interactDist&&a<r&&(r=a,o=n)}i.interactionTarget=o,o?P.style.display="block":P.style.display="none"}function G(t){i.isModalOpen=!0,K.innerHTML=t,M.style.display="flex",Object.keys(i.keys).forEach(l=>i.keys[l]=!1)}function T(){i.isModalOpen=!1,M.style.display="none"}V.addEventListener("click",T);M.addEventListener("click",t=>{t.target===M&&T()});function de(){e.fillStyle="#111",e.fillRect(0,0,h.width,h.height),e.save(),e.translate(-i.camera.x,-i.camera.y),he();const t=[...p.map(l=>({...l,drawType:"scenery",z:l.y})),...H.map(l=>({...l,drawType:"fence",z:l.y+10})),...w.map(l=>({...l,drawType:"zone",z:l.y+l.collisionBox.h+l.collisionBox.y})),...m.map(l=>({...l,drawType:"animal",z:l.y+2})),{drawType:"player",z:i.player.y+i.player.h}];if(t.sort((l,o)=>l.z-o.z),t.forEach(l=>{l.drawType==="scenery"&&C(l),l.drawType==="fence"&&pe(l),l.drawType==="zone"&&ge(l),l.drawType==="animal"&&O(l),l.drawType==="player"&&me()}),i.interactionTarget){const l=i.interactionTarget,o=l.x+l.door.x,r=l.y+l.door.y-30;e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2;const n=Math.sin(Date.now()/200)*5;e.beginPath(),e.moveTo(o-10,r+n),e.lineTo(o+10,r+n),e.lineTo(o,r+10+n),e.closePath(),e.fill(),e.stroke()}if(i.editor.active&&i.editor.tool!=="erase"){const l=i.editor.mouseX+i.camera.x,o=i.editor.mouseY+i.camera.y;e.globalAlpha=.5,["cow","chicken","horse","sheep"].includes(i.editor.tool)?O({x:l,y:o,type:i.editor.tool,isMoving:!1,frame:0}):C({x:l,y:o,type:i.editor.tool}),e.globalAlpha=1,e.strokeStyle="white",e.lineWidth=2,e.beginPath(),e.arc(l,o,20,0,Math.PI*2),e.stroke()}else if(i.editor.active&&i.editor.tool==="erase"){const l=i.editor.mouseX+i.camera.x,o=i.editor.mouseY+i.camera.y;e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.arc(l,o,15,0,Math.PI*2),e.moveTo(l-10,o-10),e.lineTo(l+10,o+10),e.moveTo(l+10,o-10),e.lineTo(l-10,o+10),e.stroke()}i.debug.showCoords&&ye(),e.restore()}function ye(){e.save(),e.lineWidth=1,e.font="10px monospace",e.strokeStyle="rgba(255, 0, 0, 0.5)",e.beginPath(),e.moveTo(c.minX,0),e.lineTo(c.maxX,0),e.stroke(),e.strokeStyle="rgba(0, 0, 255, 0.5)",e.beginPath(),e.moveTo(0,c.minY),e.lineTo(0,c.maxY),e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.textAlign="center",e.textBaseline="top";for(let t=Math.ceil(c.minX/100)*100;t<=c.maxX;t+=100)t!==0&&(e.beginPath(),e.moveTo(t,-5),e.lineTo(t,5),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fillText(t.toString(),t,8));e.textAlign="left",e.textBaseline="middle";for(let t=Math.ceil(c.minY/100)*100;t<=c.maxY;t+=100)t!==0&&(e.beginPath(),e.moveTo(-5,t),e.lineTo(5,t),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fillText(t.toString(),8,t));e.fillStyle="yellow",e.fillText("(0,0)",5,5),e.restore()}function he(){e.fillStyle=d.water,e.fillRect(i.camera.x,i.camera.y,h.width,h.height);const t=Date.now();e.fillStyle="rgba(255, 255, 255, 0.4)";const l=Math.floor(i.camera.x/50)*50,o=Math.floor(i.camera.y/50)*50,r=h.width+100,n=h.height+100;for(let s=l;s<l+r;s+=50)for(let a=o;a<o+n;a+=50){const y=Math.sin(s*99+t/1e3)*20,f=Math.cos(a*88+t/1e3)*20;if(s+y<c.minX||s+y>c.maxX||a+f<c.minY||a+f>c.maxY){const x=(Math.sin(t/500+s)+1)*2+1;e.fillRect(s+y,a+f,x*2,x)}}e.fillStyle=d.grass,e.fillRect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),e.fillStyle=d.grassDark;for(let s=c.minX;s<c.maxX;s+=50)for(let a=c.minY;a<c.maxY;a+=50)Math.abs(s*a)%7===0&&(e.fillRect(s+10,a+10,5,5),e.fillRect(s+15,a+5,5,5))}function pe(t){e.fillStyle=d.woodDark,e.fillRect(t.x,t.y-15,8,20),e.fillStyle=d.wood,e.fillRect(t.x-10,t.y-10,42,4),e.fillRect(t.x-10,t.y-2,42,4)}function C(t){t.type==="tree"?(e.fillStyle=d.woodDark,e.fillRect(t.x-8,t.y-10,16,30),e.fillStyle=d.treeLight,e.beginPath(),e.arc(t.x,t.y-30,25,0,Math.PI*2),e.fill(),e.fillStyle=d.treeDark,e.beginPath(),e.arc(t.x-10,t.y-35,15,0,Math.PI*2),e.fill()):t.type==="rock"?(e.fillStyle="#7f8c8d",e.beginPath(),e.arc(t.x,t.y,10,0,Math.PI*2),e.fill(),e.fillStyle="#95a5a6",e.fillRect(t.x-5,t.y-8,5,5)):t.type==="flower"?(e.fillStyle=d.flowerStem,e.fillRect(t.x-1,t.y,2,8),e.fillStyle=d.flowerPetal,e.beginPath(),e.arc(t.x,t.y,4,0,Math.PI*2),e.fill(),e.fillStyle="#f1c40f",e.beginPath(),e.arc(t.x,t.y,1.5,0,Math.PI*2),e.fill()):t.type==="plant"&&(e.fillStyle=d.cropLeaf,e.beginPath(),e.arc(t.x,t.y-4,6,0,Math.PI*2),e.fill(),e.fillStyle=d.cropFruit[0],e.beginPath(),e.arc(t.x,t.y-8,3,0,Math.PI*2),e.fill())}function O(t){const l=t.x,o=t.y,r=ee[t.type],n=t.isMoving&&Math.floor(t.frame)===1?2:0;e.save();let s=!1;t.type==="chicken"?t.facing==="left"&&(s=!0):t.facing==="right"&&(s=!0),s&&(e.translate(l,o),e.scale(-1,1),e.translate(-l,-o)),e.fillStyle="rgba(0,0,0,0.2)",e.beginPath(),e.ellipse(l,o+4,10,5,0,0,Math.PI*2),e.fill(),t.type==="cow"?(e.fillStyle=r.body,e.fillRect(l-14,o-20,28,20),e.fillStyle=r.spots,e.fillRect(l-8,o-18,10,8),e.fillRect(l+6,o-14,6,6),e.fillStyle=r.body,e.fillRect(l-18,o-26,16,16),e.fillStyle="#d7ccc8",e.fillRect(l-18,o-28,4,4),e.fillRect(l-6,o-28,4,4),e.fillStyle=r.body,e.fillRect(l-20,o-22,2,4),e.fillRect(l-2,o-22,2,4),e.fillStyle=r.snout,e.fillRect(l-18,o-14,16,6),e.fillStyle="#000",e.fillRect(l-16,o-20,2,2),e.fillRect(l-8,o-20,2,2),e.fillStyle=r.body,e.fillRect(l-12,o,6,6+n),e.fillRect(l+6,o,6,6-n),e.fillStyle=r.body,e.fillRect(l+14,o-18,2,10),e.fillStyle=r.spots,e.fillRect(l+13,o-8,4,4)):t.type==="chicken"?(e.fillStyle=r.body,e.fillRect(l-6,o-10,12,10),e.fillStyle=r.body,e.fillRect(l-8,o-12,4,6),e.fillStyle="#e0e0e0",e.fillRect(l-2,o-8,6,4),e.fillStyle=r.body,e.fillRect(l+2,o-14,6,6),e.fillStyle=r.comb,e.fillRect(l+3,o-16,4,2),e.fillRect(l+4,o-10,2,2),e.fillStyle=r.beak,e.fillRect(l+8,o-12,2,2),e.fillStyle="#000",e.fillRect(l+6,o-13,1,1),e.fillStyle="#e67e22",e.fillRect(l-2,o,2,4+n),e.fillRect(l+4,o,2,4-n)):t.type==="horse"?(e.fillStyle=r.body,e.fillRect(l-14,o-22,30,18),e.fillStyle=r.body,e.fillRect(l-16,o-30,10,14),e.fillStyle=r.body,e.fillRect(l-22,o-32,14,10),e.fillStyle=r.mane,e.fillRect(l-6,o-32,4,16),e.fillRect(l-16,o-34,4,4),e.fillStyle=r.body,e.fillRect(l-14,o-34,2,4),e.fillRect(l-8,o-34,2,4),e.fillStyle=r.snout,e.fillRect(l-24,o-28,4,6),e.fillStyle="#000",e.fillRect(l-18,o-28,2,2),e.fillStyle=r.body,e.fillRect(l-12,o-4,6,10+n),e.fillRect(l+8,o-4,6,10-n),e.fillStyle=r.mane,e.fillRect(l+16,o-20,4,12)):t.type==="sheep"&&(e.fillStyle=r.legs,e.fillRect(l-8,o+2,4,6+n),e.fillRect(l+4,o+2,4,6-n),e.fillStyle=r.body,e.beginPath(),e.arc(l,o-8,10,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l-6,o-6,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l+6,o-6,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l,o-12,9,0,Math.PI*2),e.fill(),e.fillStyle=r.head,e.fillRect(l-14,o-16,10,10),e.fillRect(l-16,o-14,2,4),e.fillRect(l-4,o-14,2,4),e.fillStyle=r.body,e.fillRect(l-14,o-18,10,4),e.fillStyle="#fff",e.fillRect(l-12,o-14,2,2)),e.restore()}function ge(t){if(t.type==="building")e.fillStyle="rgba(0,0,0,0.2)",e.fillRect(t.x+10,t.y+100,140,40),e.fillStyle="#f5d76e",e.fillRect(t.x+10,t.y+40,140,90),e.fillStyle=d.wood,e.fillRect(t.x+10,t.y+40,140,10),e.fillRect(t.x+10,t.y+120,140,10),e.fillRect(t.x+10,t.y+40,10,90),e.fillRect(t.x+140,t.y+40,10,90),e.fillStyle=d.roof,e.beginPath(),e.moveTo(t.x-10,t.y+40),e.lineTo(t.x+80,t.y-20),e.lineTo(t.x+170,t.y+40),e.fill(),e.fillStyle=d.woodDark,e.fillRect(t.x+60,t.y+80,40,50),e.fillStyle="#f39c12",e.fillRect(t.x+90,t.y+105,4,4),e.fillStyle="#85c1e9",e.fillRect(t.x+25,t.y+60,30,30),e.fillStyle=d.wood,e.fillRect(t.x+38,t.y+60,4,30),e.fillRect(t.x+25,t.y+73,30,4);else if(t.type==="garden"){e.fillStyle=d.dirt,e.fillRect(t.x,t.y,t.w,t.h),e.strokeStyle="rgba(0,0,0,0.1)",e.beginPath();for(let l=0;l<=t.w;l+=30)e.moveTo(t.x+l,t.y),e.lineTo(t.x+l,t.y+t.h);for(let l=0;l<=t.h;l+=30)e.moveTo(t.x,t.y+l),e.lineTo(t.x+t.w,t.y+l);e.stroke();for(let l=15;l<t.w;l+=30)for(let o=15;o<t.h;o+=30){e.fillStyle=d.cropLeaf,e.beginPath(),e.arc(t.x+l,t.y+o,10,0,Math.PI*2),e.fill();const r=d.cropFruit,n=r[(l+o)%r.length];e.fillStyle=n,e.beginPath(),e.arc(t.x+l,t.y+o-5,4,0,Math.PI*2),e.fill()}}else t.type==="sign"?(e.fillStyle=d.wood,e.fillRect(t.x+15,t.y+30,5,20),e.fillRect(t.x+60,t.y+30,5,20),e.fillStyle=d.woodDark,e.fillRect(t.x,t.y,t.w,40),e.fillStyle="#fff",e.fillRect(t.x+5,t.y+5,t.w-10,30),e.fillStyle="#333",e.fillRect(t.x+10,t.y+15,t.w-20,2),e.fillRect(t.x+10,t.y+25,t.w-20,2)):t.type==="mailbox"&&(e.fillStyle="#bdc3c7",e.fillRect(t.x+12,t.y+20,6,30),e.fillStyle="#34495e",e.beginPath(),e.arc(t.x+15,t.y+10,15,Math.PI,0),e.lineTo(t.x+30,t.y+20),e.lineTo(t.x,t.y+20),e.fill(),e.fillStyle="#c0392b",e.fillRect(t.x+28,t.y+5,2,10),e.fillRect(t.x+28,t.y+5,8,5))}function me(){const t=i.player,l=t.x,o=t.y;if(e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(l+16,o+30,10,4,0,0,Math.PI*2),e.fill(),e.fillStyle="#2c3e50",t.isMoving){const r=Math.sin(Date.now()/100)*5;e.fillRect(l+8,o+20+r,6,12),e.fillRect(l+18,o+20-r,6,12)}else e.fillRect(l+8,o+20,6,12),e.fillRect(l+18,o+20,6,12);e.fillStyle="#e74c3c",e.fillRect(l+6,o+12,20,14),e.fillStyle="#f1c40f",e.fillRect(l+8,o,16,14),e.fillStyle="#2980b9",e.fillRect(l+6,o-4,20,6),e.fillRect(l+8,o-8,16,6),e.fillStyle="black",t.dir==="down"?(e.fillRect(l+12,o+6,2,2),e.fillRect(l+18,o+6,2,2)):t.dir==="right"?e.fillRect(l+18,o+6,2,2):t.dir==="left"&&e.fillRect(l+12,o+6,2,2),e.fillStyle="white",e.font='10px "Press Start 2P"',e.fillText("Me",l+6,o-15)}function Q(t){const l=t-i.lastTime;i.lastTime=t,ce(l),de(),requestAnimationFrame(Q)}ae();
