import"./modulepreload-polyfill-B5Qt9EMX.js";const h=document.getElementById("gameCanvas"),e=h.getContext("2d"),A=document.getElementById("interaction-prompt"),M=document.getElementById("modal-overlay"),ee=document.getElementById("modal-body"),te=document.getElementById("close-btn");let I,u,w,R,B,H,U;const le=`
<div id="settings-panel">
    <div class="panel-header" id="panel-header">
        <span>‚öôÔ∏è MENU</span>
        <span id="toggle-icon">‚ñº</span>
    </div>
    <div class="panel-body">
        <div class="control-group">
            <span class="control-label">Current Season</span>
            <button class="pixel-btn" id="season-btn">SPRING</button>
        </div>
        <div class="control-group">
            <span class="control-label">Map Editor</span>
            <button class="pixel-btn" id="editor-toggle-btn">Enable Editing</button>
            <div id="editor-tools">
                <button class="tool-btn active" onclick="setTool('tree')">üå≤</button>
                <button class="tool-btn" onclick="setTool('rock')">ü™®</button>
                <button class="tool-btn" onclick="setTool('flower')">üå∏</button>
                <button class="tool-btn" onclick="setTool('plant')">üåø</button>
                <button class="tool-btn" onclick="setTool('cow')">üêÑ</button>
                <button class="tool-btn" onclick="setTool('chicken')">üêî</button>
                <button class="tool-btn" onclick="setTool('horse')">üêé</button>
                <button class="tool-btn" onclick="setTool('sheep')">üêè</button>
                <button class="tool-btn" onclick="setTool('erase')">‚ùå</button>
            </div>
        </div>
        <div class="control-group">
            <button class="pixel-btn" onclick="exportMap()" style="font-size: 8px;">üíæ Copy Map JSON</button>
        </div>
        <div class="control-group">
            <span class="control-label">Debug</span>
            <button class="pixel-btn" id="debug-toggle-btn">Show Coords</button>
        </div>
    </div>
</div>`;window.openSesame=function(){if(document.getElementById("settings-panel"))return;const t=document.getElementById("ui-layer"),l=document.getElementById("interaction-prompt"),o=document.createElement("div");o.innerHTML=le,t.insertBefore(o.firstElementChild,l),I=document.getElementById("settings-panel"),u=document.getElementById("season-btn"),w=document.getElementById("editor-toggle-btn"),R=document.getElementById("debug-toggle-btn"),B=document.getElementById("editor-tools"),H=document.getElementById("panel-header"),U=document.getElementById("toggle-icon"),re(),u&&(u.innerText=X[i.season.current]),console.log("Developer Mode Enabled")};const k=4,S=32,oe=6e4,X=["Spring","Summer","Fall","Winter"],c={minX:-800,maxX:800,minY:-600,maxY:600},v=.5,ie={cow:{body:"#e3dac9",spots:"#5d4037",snout:"#f8bbd0"},chicken:{body:"#ffffff",comb:"#c0392b",beak:"#f1c40f"},horse:{body:"#a1887f",mane:"#5d4037",snout:"#d7ccc8"},sheep:{body:"#ecf0f1",head:"#34495e",legs:"#34495e"}},Z={Spring:{grass:"#76c758",grassDark:"#66b04a",dirt:"#8b5e3c",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#c0392b",water:"#3498db",treeLight:"#2ecc71",treeDark:"#27ae60",flowerStem:"#27ae60",flowerPetal:"#e74c3c",cropLeaf:"#2ecc71",cropFruit:["#e74c3c","#f1c40f","#9b59b6"]},Summer:{grass:"#53c738",grassDark:"#41a02a",dirt:"#8b5e3c",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#c0392b",water:"#3498db",treeLight:"#2ecc71",treeDark:"#27ae60",flowerStem:"#27ae60",flowerPetal:"#f39c12",cropLeaf:"#27ae60",cropFruit:["#c0392b","#e67e22","#f39c12"]},Fall:{grass:"#d68910",grassDark:"#b9770e",dirt:"#6e4c30",wood:"#a05a2c",woodDark:"#6d3d1e",roof:"#922b21",water:"#2e86c1",treeLight:"#e67e22",treeDark:"#d35400",flowerStem:"#8b5e3c",flowerPetal:"#8e44ad",cropLeaf:"#d35400",cropFruit:["#e67e22","#8e44ad","#c0392b"]},Winter:{grass:"#ecf0f1",grassDark:"#bdc3c7",dirt:"#95a5a6",wood:"#7f8c8d",woodDark:"#555",roof:"#2c3e50",water:"#aed6f1",treeLight:"#dfe6e9",treeDark:"#b2babb",flowerStem:"#95a5a6",flowerPetal:"#3498db",cropLeaf:"#bdc3c7",cropFruit:["#ecf0f1","#95a5a6","#7f8c8d"]}};let d={...Z.Spring},i={player:{x:0,y:0,w:S,h:S,dir:"down",isMoving:!1},keys:{w:!1,a:!1,s:!1,d:!1,ArrowUp:!1,ArrowLeft:!1,ArrowDown:!1,ArrowRight:!1," ":!1,Enter:!1},camera:{x:0,y:0},interactionTarget:null,isModalOpen:!1,lastTime:0,season:{current:0,timer:0},editor:{active:!1,tool:"tree",mouseX:0,mouseY:0},debug:{showCoords:!1}};const x=[{id:"house",x:-80,y:-300,w:160,h:140,type:"building",label:"My House",interactDist:60,collisionBox:{x:10,y:40,w:140,h:90},door:{x:70,y:130},content:`
            <h2>About Me</h2>
            <p>Hi! I'm <strong>Louis</strong>, I'm a full-stack web developer with a strong focus on web technologies.</p>
            <h3>Skills</h3>
            <ul>
                <li>JavaScript, TypeScript (React, Node.js, Angular, Backbone, ...)</li>
                <li>Ruby on Rails</li>
                <li>HTML, CSS</li>
                <li>Database Design (SQL, NoSQL)</li>
                <li>Cloud platform (AWS)</li>
            </ul>
        `},{id:"field1",x:100,y:0,w:150,h:150,type:"garden",label:"Projects Field",interactDist:80,collisionBox:{x:0,y:0,w:150,h:150},door:{x:75,y:150},content:`
            <h2>Projects Field</h2>
            <p>Here is what I've been growing lately:</p>

            <h3>
                <a href="https://github.com/Snap-Mind/snap-mind" target="_blank" style="color: #d35400; text-decoration: none;">üß† SnapMind</a>
            </h3>
            <p>A cross-platform desktop AI assistant that lets you translate, rewrite, summarize, and brainstorm with just a hotkey.</p>

            <h3>üß¨ Cytobank</h3>
            <p>A cloud-based Flow Cytometry data analysis platform.</p>

            <h3>üîÅ Aldon Lifecycle Management</h3>
            <p>A Software Life Management tool on IBM i.</p>

            <h3>üßë‚Äçüíª Zowe Code Editor</h3>
            <p>A plug-in of Zowe running on IBM mainframe.</p>
        `},{id:"board",x:-250,y:-210,w:80,h:60,type:"sign",label:"Blog Board",interactDist:50,collisionBox:{x:10,y:10,w:60,h:50},door:{x:40,y:65},content:`
            <h2>Community Board (Blog)</h2>

            <h3>üìÖ Fetching</h3>
            <p>Loading my blogs...</p>
        `},{id:"mailbox",x:130,y:-210,w:30,h:50,type:"mailbox",label:"Resume/Contact",interactDist:40,collisionBox:{x:0,y:0,w:30,h:50},door:{x:15,y:55},content:`
            <h2>Contact Me</h2>
            <p><strong>Email:</strong> <a href="mailto:louisgh.cn@gmail.com" style="color: #d35400;">louisgh.cn@gmail.com</a></p>
            <hr>
            <h3>Social Medias</h3>
            <p><strong>GitHub:</strong> <a href="https://github.com/louis-7" target="_blank" style="color: #d35400;">github.com/louis-7</a></p>
            <p><strong>Dev.to:</strong> <a href="https://dev.to/louis7" target="_blank" style="color: #d35400;">dev.to/louis7</a></p>
            <p><strong>LinkedIn:</strong> <a href="https://www.linkedin.com/in/louis360" target="_blank" style="color: #d35400;">linkedin.com/in/louis360</a></p>
        `}];let p=[],m=[],$=[];function W(t,l,o){m.push({x:l,y:o,type:t,dir:"down",facing:t==="chicken"?"right":"left",frame:0,isMoving:!1,moveTimer:Math.random()*2e3})}function ne(){p=[],m=[],$=[],["cow","cow","chicken","chicken","chicken","horse","sheep","sheep"].forEach(l=>{let o=!1,s=0;for(;!o&&s<50;){let n,r;s<20?(n=150+Math.random()*400,r=-200+Math.random()*400):(n=Math.random()*(c.maxX-c.minX)+c.minX,r=Math.random()*(c.maxY-c.minY)+c.minY);let a=!1;const y=40;for(const f of x)if(n>f.x-y&&n<f.x+f.w+y&&r>f.y-y&&r<f.y+f.h+y){a=!0;break}a||(W(l,n,r),o=!0),s++}});for(let l=0;l<100;l++){const o=Math.random()*(c.maxX-c.minX)+c.minX,s=Math.random()*(c.maxY-c.minY)+c.minY;let n=!1;const r=30;for(const a of x)if(o>a.x-r&&o<a.x+a.w+r&&s>a.y-r&&s<a.y+a.h+r){n=!0;break}o>130&&o<570&&s>-220&&s<320&&(n=!0),!n&&p.push({x:o,y:s,type:Math.random()>.7?"rock":"tree"})}p.push({x:-150,y:-250,type:"tree"}),p.push({x:80,y:-250,type:"tree"}),p.push({x:-400,y:-200,type:"rock"})}function J(){i.season.current=(i.season.current+1)%X.length,i.season.timer=0,se()}function se(){const t=X[i.season.current];d={...Z[t]},u&&(u.innerText=t),console.log("Season changed to "+t)}function re(){u&&u.addEventListener("click",J),H.addEventListener("click",()=>{I.classList.toggle("minimized"),U.innerText=I.classList.contains("minimized")?"‚ñ∂":"‚ñº"}),w.addEventListener("click",()=>{i.editor.active=!i.editor.active,i.editor.active?(w.innerText="Disable Editing",w.classList.add("active"),B.style.display="grid"):(w.innerText="Enable Editing",w.classList.remove("active"),B.style.display="none")}),R.addEventListener("click",()=>{i.debug.showCoords=!i.debug.showCoords,R.classList.toggle("active"),R.innerText=i.debug.showCoords?"Hide Coords":"Show Coords"})}window.setTool=function(t){i.editor.tool=t,document.querySelectorAll("#editor-tools .tool-btn").forEach(l=>{l.outerHTML.includes(t)?l.classList.add("active"):l.classList.remove("active")})};window.exportMap=function(){const t=JSON.stringify({scenery:p,animals:m});navigator.clipboard.writeText(t).then(()=>{alert("Map data copied to clipboard! You can save this JSON.")}),console.log(t)};h.addEventListener("mousemove",t=>{const l=h.getBoundingClientRect();i.editor.mouseX=t.clientX-l.left,i.editor.mouseY=t.clientY-l.top});h.addEventListener("mousedown",t=>{if(!i.editor.active)return;const l=h.getBoundingClientRect(),o=t.clientX-l.left,s=t.clientY-l.top,n=Math.round(o+i.camera.x),r=Math.round(s+i.camera.y),a=30;if(i.editor.tool==="erase"){let y=p.findIndex(f=>Math.hypot(f.x-n,f.y-r)<a);y!==-1?p.splice(y,1):(y=m.findIndex(f=>Math.hypot(f.x-n,f.y-r)<a),y!==-1&&m.splice(y,1))}else["cow","chicken","horse","sheep"].includes(i.editor.tool)?W(i.editor.tool,n,r):p.push({x:n,y:r,type:i.editor.tool})});window.addEventListener("keydown",t=>{if((i.keys.hasOwnProperty(t.key)||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&(i.keys[t.key]=!0),(t.key==="Escape"||t.key===" ")&&i.isModalOpen){E();return}(t.key===" "||t.key==="Enter")&&!i.isModalOpen&&i.interactionTarget&&j(i.interactionTarget.content)});window.addEventListener("keyup",t=>{(i.keys.hasOwnProperty(t.key)||t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")&&(i.keys[t.key]=!1)});const g=document.getElementById("joystick"),V=document.getElementById("joystick-knob"),D=document.getElementById("btn-action"),Y=document.getElementById("btn-close"),ae=document.getElementById("mobile-controls"),q="ontouchstart"in window||navigator.maxTouchPoints>0;q&&(ae.style.display="block",A.innerText="Tap 'A' to Interact");function T(){if(!q)return;const t=window.visualViewport,s=(t?t.height:window.innerHeight)-20;g.style.bottom="auto",g.style.top=`calc(${s}px - 120px)`,D.style.bottom="auto",D.style.top=`calc(${s}px - 60px)`,Y.style.bottom="auto",Y.style.top=`calc(${s}px - 120px)`}T();window.addEventListener("resize",T);window.visualViewport&&(window.visualViewport.addEventListener("resize",T),window.visualViewport.addEventListener("scroll",T));let C=!1,L={x:0,y:0};const P=35;function G(t,l){const o=g.getBoundingClientRect();L={x:o.left+o.width/2,y:o.top+o.height/2};let s=t-L.x,n=l-L.y;const r=Math.sqrt(s*s+n*n);r>P&&(s=s/r*P,n=n/r*P),V.style.transform=`translate(calc(-50% + ${s}px), calc(-50% + ${n}px))`,i.keys.ArrowUp=!1,i.keys.ArrowDown=!1,i.keys.ArrowLeft=!1,i.keys.ArrowRight=!1;const a=15;r>a&&(n<-a*.5&&(i.keys.ArrowUp=!0),n>a*.5&&(i.keys.ArrowDown=!0),s<-a*.5&&(i.keys.ArrowLeft=!0),s>a*.5&&(i.keys.ArrowRight=!0))}function Q(){C=!1,V.style.transform="translate(-50%, -50%)",i.keys.ArrowUp=!1,i.keys.ArrowDown=!1,i.keys.ArrowLeft=!1,i.keys.ArrowRight=!1}g.addEventListener("touchstart",t=>{t.preventDefault(),C=!0;const l=t.touches[0];G(l.clientX,l.clientY)});g.addEventListener("touchmove",t=>{if(t.preventDefault(),C){const l=t.touches[0];G(l.clientX,l.clientY)}});g.addEventListener("touchend",t=>{t.preventDefault(),Q()});g.addEventListener("touchcancel",t=>{t.preventDefault(),Q()});D.addEventListener("touchstart",t=>{t.preventDefault(),!i.isModalOpen&&i.interactionTarget&&j(i.interactionTarget.content)});Y.addEventListener("touchstart",t=>{t.preventDefault(),i.isModalOpen&&E()});async function ce(){const t=x.find(l=>l.id==="board");if(t){t.content="<h2>Community Board (Blog)</h2><p>Loading articles...</p>";try{const o=await(await fetch("https://dev.to/api/articles?username=louis7")).json();let s="<h2>Community Board (Blog)</h2>";o.forEach(n=>{const r=new Date(n.published_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});s+=`
                <div class="blog-item" style="margin-bottom: 20px; border-bottom: 1px dashed #8b4513; padding-bottom: 10px;">
                    <h3 style="margin-bottom: 8px; font-size: 14px;">
                        <a href="${n.url}" target="_blank" style="color: #d35400; text-decoration: none;">${n.title}</a>
                    </h3>
                    <p style="font-size: 10px; color: #555; margin: 0;">
                        ‚è≥ ${n.reading_time_minutes} min ¬∑ üìÖ ${r} ¬∑ ‚ù§Ô∏è ${n.public_reactions_count}
                    </p>
                </div>
            `}),t.content=s}catch(l){console.error(l),t.content=`
            <h2>Community Board (Blog)</h2>
            <p>Failed to load blogs.</p>
            <p>Check out <a href="https://dev.to/louis7" target="_blank">dev.to/louis7</a></p>
        `}}}async function fe(){O(),window.addEventListener("resize",O),ne();const t=new Promise(a=>setTimeout(a,2e3)),l=new Promise(a=>setTimeout(a,5e3)),o=document.fonts.ready.catch(a=>console.warn("Font load warning:",a)),s=ce().catch(a=>console.warn("Blog load warning:",a)),n=Promise.all([o,s]);await Promise.all([t,Promise.race([n,l])]),i.player.x=0,i.player.y=-150;const r=document.getElementById("loading-screen");r.classList.add("fade-out"),requestAnimationFrame(z),setTimeout(()=>{r.style.display="none"},1e3)}function O(){h.width=window.innerWidth,h.height=window.innerHeight,e.imageSmoothingEnabled=!1}function de(t){if(i.isModalOpen)return;i.season.timer+=t,i.season.timer>=oe&&J(),m.forEach(n=>{if(n.moveTimer-=t,n.isMoving)if(n.moveTimer<=0)n.isMoving=!1,n.frame=0,n.moveTimer=1e3+Math.random()*2e3;else{let r=0,a=0;n.dir==="up"&&(a=-v),n.dir==="down"&&(a=v),n.dir==="left"&&(r=-v,n.facing="left"),n.dir==="right"&&(r=v,n.facing="right");let y=n.x+r,f=n.y+a;if((y<c.minX+20||y>c.maxX-20)&&(y=n.x),(f<c.minY+20||f>c.maxY-20)&&(f=n.y),K({x:y-10,y:f-5,w:20,h:10})){y=n.x,f=n.y;const b=["up","down","left","right"];n.dir=b[Math.floor(Math.random()*b.length)]}n.x=y,n.y=f,n.frame=(n.frame+t*.01)%2}else if(n.moveTimer<=0){n.isMoving=!0,n.moveTimer=2e3+Math.random()*3e3;const r=["up","down","left","right"];n.dir=r[Math.floor(Math.random()*r.length)]}});const l=i.player;let o=0,s=0;if((i.keys.w||i.keys.ArrowUp)&&(s=-k),(i.keys.s||i.keys.ArrowDown)&&(s=k),(i.keys.a||i.keys.ArrowLeft)&&(o=-k),(i.keys.d||i.keys.ArrowRight)&&(o=k),o!==0&&s!==0&&(o*=.707,s*=.707),o!==0||s!==0){l.isMoving=!0,Math.abs(o)>Math.abs(s)?l.dir=o>0?"right":"left":l.dir=s>0?"down":"up";let n=l.x+o,r=l.y+s;n<c.minX&&(n=l.x),n>c.maxX-l.w&&(n=l.x),r<c.minY&&(r=l.y),r>c.maxY-l.h&&(r=l.y),_(n,l.y)||(l.x=n),_(l.x,r)||(l.y=r)}else l.isMoving=!1;ye(),i.camera.x=l.x-h.width/2+l.w/2,i.camera.y=l.y-h.height/2+l.h/2}function K(t){for(let l of x){const o=l.collisionBox,s=l.x+o.x,n=l.y+o.y;if(t.x<s+o.w&&t.x+t.w>s&&t.y<n+o.h&&t.y+t.h>n)return!0}return!1}function _(t,l){const o={x:t,y:l+S/2,w:S,h:S/2};return K(o)}function ye(){const t=i.player,l={x:t.x+t.w/2,y:t.y+t.h/2};let o=null,s=1/0;for(let n of x){const r={x:n.x+n.door.x,y:n.y+n.door.y},a=Math.hypot(l.x-r.x,l.y-r.y);a<n.interactDist&&a<s&&(s=a,o=n)}i.interactionTarget=o,o?A.style.display="block":A.style.display="none"}function j(t){i.isModalOpen=!0,ee.innerHTML=t,M.style.display="flex",Object.keys(i.keys).forEach(l=>i.keys[l]=!1)}function E(){i.isModalOpen=!1,M.style.display="none"}te.addEventListener("click",E);M.addEventListener("click",t=>{t.target===M&&E()});function he(){e.fillStyle="#111",e.fillRect(0,0,h.width,h.height),e.save(),e.translate(-i.camera.x,-i.camera.y),ue();const t=[...p.map(l=>({...l,drawType:"scenery",z:l.y})),...$.map(l=>({...l,drawType:"fence",z:l.y+10})),...x.map(l=>({...l,drawType:"zone",z:l.y+l.collisionBox.h+l.collisionBox.y})),...m.map(l=>({...l,drawType:"animal",z:l.y+2})),{drawType:"player",z:i.player.y+i.player.h}];if(t.sort((l,o)=>l.z-o.z),t.forEach(l=>{l.drawType==="scenery"&&F(l),l.drawType==="fence"&&me(l),l.drawType==="zone"&&ge(l),l.drawType==="animal"&&N(l),l.drawType==="player"&&we()}),i.interactionTarget){const l=i.interactionTarget,o=l.x+l.door.x,s=l.y+l.door.y-30;e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2;const n=Math.sin(Date.now()/200)*5;e.beginPath(),e.moveTo(o-10,s+n),e.lineTo(o+10,s+n),e.lineTo(o,s+10+n),e.closePath(),e.fill(),e.stroke()}if(i.editor.active&&i.editor.tool!=="erase"){const l=i.editor.mouseX+i.camera.x,o=i.editor.mouseY+i.camera.y;e.globalAlpha=.5,["cow","chicken","horse","sheep"].includes(i.editor.tool)?N({x:l,y:o,type:i.editor.tool,isMoving:!1,frame:0}):F({x:l,y:o,type:i.editor.tool}),e.globalAlpha=1,e.strokeStyle="white",e.lineWidth=2,e.beginPath(),e.arc(l,o,20,0,Math.PI*2),e.stroke()}else if(i.editor.active&&i.editor.tool==="erase"){const l=i.editor.mouseX+i.camera.x,o=i.editor.mouseY+i.camera.y;e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.arc(l,o,15,0,Math.PI*2),e.moveTo(l-10,o-10),e.lineTo(l+10,o+10),e.moveTo(l+10,o-10),e.lineTo(l-10,o+10),e.stroke()}i.debug.showCoords&&pe(),e.restore()}function pe(){e.save(),e.lineWidth=1,e.font="10px monospace",e.strokeStyle="rgba(255, 0, 0, 0.5)",e.beginPath(),e.moveTo(c.minX,0),e.lineTo(c.maxX,0),e.stroke(),e.strokeStyle="rgba(0, 0, 255, 0.5)",e.beginPath(),e.moveTo(0,c.minY),e.lineTo(0,c.maxY),e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.textAlign="center",e.textBaseline="top";for(let t=Math.ceil(c.minX/100)*100;t<=c.maxX;t+=100)t!==0&&(e.beginPath(),e.moveTo(t,-5),e.lineTo(t,5),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fillText(t.toString(),t,8));e.textAlign="left",e.textBaseline="middle";for(let t=Math.ceil(c.minY/100)*100;t<=c.maxY;t+=100)t!==0&&(e.beginPath(),e.moveTo(-5,t),e.lineTo(5,t),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fillText(t.toString(),8,t));e.fillStyle="yellow",e.fillText("(0,0)",5,5),e.restore()}function ue(){e.fillStyle=d.water,e.fillRect(i.camera.x,i.camera.y,h.width,h.height);const t=Date.now();e.fillStyle="rgba(255, 255, 255, 0.4)";const l=Math.floor(i.camera.x/50)*50,o=Math.floor(i.camera.y/50)*50,s=h.width+100,n=h.height+100;for(let r=l;r<l+s;r+=50)for(let a=o;a<o+n;a+=50){const y=Math.sin(r*99+t/1e3)*20,f=Math.cos(a*88+t/1e3)*20;if(r+y<c.minX||r+y>c.maxX||a+f<c.minY||a+f>c.maxY){const b=(Math.sin(t/500+r)+1)*2+1;e.fillRect(r+y,a+f,b*2,b)}}e.fillStyle=d.grass,e.fillRect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),e.fillStyle=d.grassDark;for(let r=c.minX;r<c.maxX;r+=50)for(let a=c.minY;a<c.maxY;a+=50)Math.abs(r*a)%7===0&&(e.fillRect(r+10,a+10,5,5),e.fillRect(r+15,a+5,5,5))}function me(t){e.fillStyle=d.woodDark,e.fillRect(t.x,t.y-15,8,20),e.fillStyle=d.wood,e.fillRect(t.x-10,t.y-10,42,4),e.fillRect(t.x-10,t.y-2,42,4)}function F(t){t.type==="tree"?(e.fillStyle=d.woodDark,e.fillRect(t.x-8,t.y-10,16,30),e.fillStyle=d.treeLight,e.beginPath(),e.arc(t.x,t.y-30,25,0,Math.PI*2),e.fill(),e.fillStyle=d.treeDark,e.beginPath(),e.arc(t.x-10,t.y-35,15,0,Math.PI*2),e.fill()):t.type==="rock"?(e.fillStyle="#7f8c8d",e.beginPath(),e.arc(t.x,t.y,10,0,Math.PI*2),e.fill(),e.fillStyle="#95a5a6",e.fillRect(t.x-5,t.y-8,5,5)):t.type==="flower"?(e.fillStyle=d.flowerStem,e.fillRect(t.x-1,t.y,2,8),e.fillStyle=d.flowerPetal,e.beginPath(),e.arc(t.x,t.y,4,0,Math.PI*2),e.fill(),e.fillStyle="#f1c40f",e.beginPath(),e.arc(t.x,t.y,1.5,0,Math.PI*2),e.fill()):t.type==="plant"&&(e.fillStyle=d.cropLeaf,e.beginPath(),e.arc(t.x,t.y-4,6,0,Math.PI*2),e.fill(),e.fillStyle=d.cropFruit[0],e.beginPath(),e.arc(t.x,t.y-8,3,0,Math.PI*2),e.fill())}function N(t){const l=t.x,o=t.y,s=ie[t.type],n=t.isMoving&&Math.floor(t.frame)===1?2:0;e.save();let r=!1;t.type==="chicken"?t.facing==="left"&&(r=!0):t.facing==="right"&&(r=!0),r&&(e.translate(l,o),e.scale(-1,1),e.translate(-l,-o)),e.fillStyle="rgba(0,0,0,0.2)",e.beginPath(),e.ellipse(l,o+4,10,5,0,0,Math.PI*2),e.fill(),t.type==="cow"?(e.fillStyle=s.body,e.fillRect(l-14,o-20,28,20),e.fillStyle=s.spots,e.fillRect(l-8,o-18,10,8),e.fillRect(l+6,o-14,6,6),e.fillStyle=s.body,e.fillRect(l-18,o-26,16,16),e.fillStyle="#d7ccc8",e.fillRect(l-18,o-28,4,4),e.fillRect(l-6,o-28,4,4),e.fillStyle=s.body,e.fillRect(l-20,o-22,2,4),e.fillRect(l-2,o-22,2,4),e.fillStyle=s.snout,e.fillRect(l-18,o-14,16,6),e.fillStyle="#000",e.fillRect(l-16,o-20,2,2),e.fillRect(l-8,o-20,2,2),e.fillStyle=s.body,e.fillRect(l-12,o,6,6+n),e.fillRect(l+6,o,6,6-n),e.fillStyle=s.body,e.fillRect(l+14,o-18,2,10),e.fillStyle=s.spots,e.fillRect(l+13,o-8,4,4)):t.type==="chicken"?(e.fillStyle=s.body,e.fillRect(l-6,o-10,12,10),e.fillStyle=s.body,e.fillRect(l-8,o-12,4,6),e.fillStyle="#e0e0e0",e.fillRect(l-2,o-8,6,4),e.fillStyle=s.body,e.fillRect(l+2,o-14,6,6),e.fillStyle=s.comb,e.fillRect(l+3,o-16,4,2),e.fillRect(l+4,o-10,2,2),e.fillStyle=s.beak,e.fillRect(l+8,o-12,2,2),e.fillStyle="#000",e.fillRect(l+6,o-13,1,1),e.fillStyle="#e67e22",e.fillRect(l-2,o,2,4+n),e.fillRect(l+4,o,2,4-n)):t.type==="horse"?(e.fillStyle=s.body,e.fillRect(l-14,o-22,30,18),e.fillStyle=s.body,e.fillRect(l-16,o-30,10,14),e.fillStyle=s.body,e.fillRect(l-22,o-32,14,10),e.fillStyle=s.mane,e.fillRect(l-6,o-32,4,16),e.fillRect(l-16,o-34,4,4),e.fillStyle=s.body,e.fillRect(l-14,o-34,2,4),e.fillRect(l-8,o-34,2,4),e.fillStyle=s.snout,e.fillRect(l-24,o-28,4,6),e.fillStyle="#000",e.fillRect(l-18,o-28,2,2),e.fillStyle=s.body,e.fillRect(l-12,o-4,6,10+n),e.fillRect(l+8,o-4,6,10-n),e.fillStyle=s.mane,e.fillRect(l+16,o-20,4,12)):t.type==="sheep"&&(e.fillStyle=s.legs,e.fillRect(l-8,o+2,4,6+n),e.fillRect(l+4,o+2,4,6-n),e.fillStyle=s.body,e.beginPath(),e.arc(l,o-8,10,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l-6,o-6,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l+6,o-6,8,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(l,o-12,9,0,Math.PI*2),e.fill(),e.fillStyle=s.head,e.fillRect(l-14,o-16,10,10),e.fillRect(l-16,o-14,2,4),e.fillRect(l-4,o-14,2,4),e.fillStyle=s.body,e.fillRect(l-14,o-18,10,4),e.fillStyle="#fff",e.fillRect(l-12,o-14,2,2)),e.restore()}function ge(t){if(t.type==="building")e.fillStyle="rgba(0,0,0,0.2)",e.fillRect(t.x+10,t.y+100,140,40),e.fillStyle="#f5d76e",e.fillRect(t.x+10,t.y+40,140,90),e.fillStyle=d.wood,e.fillRect(t.x+10,t.y+40,140,10),e.fillRect(t.x+10,t.y+120,140,10),e.fillRect(t.x+10,t.y+40,10,90),e.fillRect(t.x+140,t.y+40,10,90),e.fillStyle=d.roof,e.beginPath(),e.moveTo(t.x-10,t.y+40),e.lineTo(t.x+80,t.y-20),e.lineTo(t.x+170,t.y+40),e.fill(),e.fillStyle=d.woodDark,e.fillRect(t.x+60,t.y+80,40,50),e.fillStyle="#f39c12",e.fillRect(t.x+90,t.y+105,4,4),e.fillStyle="#85c1e9",e.fillRect(t.x+25,t.y+60,30,30),e.fillStyle=d.wood,e.fillRect(t.x+38,t.y+60,4,30),e.fillRect(t.x+25,t.y+73,30,4);else if(t.type==="garden"){e.fillStyle=d.dirt,e.fillRect(t.x,t.y,t.w,t.h),e.strokeStyle="rgba(0,0,0,0.1)",e.beginPath();for(let l=0;l<=t.w;l+=30)e.moveTo(t.x+l,t.y),e.lineTo(t.x+l,t.y+t.h);for(let l=0;l<=t.h;l+=30)e.moveTo(t.x,t.y+l),e.lineTo(t.x+t.w,t.y+l);e.stroke();for(let l=15;l<t.w;l+=30)for(let o=15;o<t.h;o+=30){e.fillStyle=d.cropLeaf,e.beginPath(),e.arc(t.x+l,t.y+o,10,0,Math.PI*2),e.fill();const s=d.cropFruit,n=s[(l+o)%s.length];e.fillStyle=n,e.beginPath(),e.arc(t.x+l,t.y+o-5,4,0,Math.PI*2),e.fill()}}else t.type==="sign"?(e.fillStyle=d.wood,e.fillRect(t.x+15,t.y+30,5,20),e.fillRect(t.x+60,t.y+30,5,20),e.fillStyle=d.woodDark,e.fillRect(t.x,t.y,t.w,40),e.fillStyle="#fff",e.fillRect(t.x+5,t.y+5,t.w-10,30),e.fillStyle="#333",e.fillRect(t.x+10,t.y+15,t.w-20,2),e.fillRect(t.x+10,t.y+25,t.w-20,2)):t.type==="mailbox"&&(e.fillStyle="#bdc3c7",e.fillRect(t.x+12,t.y+20,6,30),e.fillStyle="#34495e",e.beginPath(),e.arc(t.x+15,t.y+10,15,Math.PI,0),e.lineTo(t.x+30,t.y+20),e.lineTo(t.x,t.y+20),e.fill(),e.fillStyle="#c0392b",e.fillRect(t.x+28,t.y+5,2,10),e.fillRect(t.x+28,t.y+5,8,5))}function we(){const t=i.player,l=t.x,o=t.y;if(e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(l+16,o+30,10,4,0,0,Math.PI*2),e.fill(),e.fillStyle="#2c3e50",t.isMoving){const s=Math.sin(Date.now()/100)*5;e.fillRect(l+8,o+20+s,6,12),e.fillRect(l+18,o+20-s,6,12)}else e.fillRect(l+8,o+20,6,12),e.fillRect(l+18,o+20,6,12);e.fillStyle="#e74c3c",e.fillRect(l+6,o+12,20,14),e.fillStyle="#f1c40f",e.fillRect(l+8,o,16,14),e.fillStyle="#2980b9",e.fillRect(l+6,o-4,20,6),e.fillRect(l+8,o-8,16,6),e.fillStyle="black",t.dir==="down"?(e.fillRect(l+12,o+6,2,2),e.fillRect(l+18,o+6,2,2)):t.dir==="right"?e.fillRect(l+18,o+6,2,2):t.dir==="left"&&e.fillRect(l+12,o+6,2,2),e.fillStyle="white",e.font='10px "Press Start 2P"',e.fillText("Me",l+6,o-15)}function z(t){const l=t-i.lastTime;i.lastTime=t,de(l),he(),requestAnimationFrame(z)}fe();
